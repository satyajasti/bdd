import pandas as pd

# Function to merge multiple Excel files into one Excel file with multiple sheets
def merge_excel_files(output_file):
    # Get the list of input file names from the user
    file_names = input("Enter the file names (comma-separated): ").split(',')

    # Create an Excel writer to save the merged output
    with pd.ExcelWriter(output_file, engine='openpyxl') as writer:
        # Loop through each provided Excel file
        for idx, file_name in enumerate(file_names):
            file_name = file_name.strip()  # Clean file name
            
            # Read the Excel file
            df = pd.read_excel(file_name)
            
            # Create a sheet name based on the file name (without extension)
            sheet_name = f"Sheet_{idx+1}"
            
            # Write the DataFrame to a sheet in the output Excel file
            df.to_excel(writer, sheet_name=sheet_name, index=False)

    print(f"Merged files successfully written to {output_file}")

# Main function
def main():
    # Get the output file name from the user
    output_file = input("Enter the output file name (with .xlsx extension): ").strip()

    # Merge the Excel files
    merge_excel_files(output_file)

if __name__ == "__main__":
    main()
